import{_ as D,r as l,o as F,e as J,a as s,f as n,J as x,h as S,A as L,l as C,x as $,j as b,i as Q,B as R}from"./index-C2blXwEK.js";import{c as j,d as q,e as _}from"./index-DexdYQBf.js";import{B as K,K as P}from"./Col-BQnMq_kH.js";import{_ as G,R as H}from"./ReloadOutlined-DoUCwVyo.js";import{F as X,_ as Y}from"./index-CbRG_8c-.js";import{a as Z,I as ee}from"./index-1PGfYYHc.js";const ae={class:"sensitive-word-container"},te={__name:"SensitiveWords",setup(oe){const g=l(""),m=l([]),v=l(!1),w=l(!1),f=l(!1),y=l(!1),u=l(""),h=l(0),r=l({pageSize:10,total:0,current:1,showSizeChanger:!0,pageSizeOptions:["10","20","50","100"],showQuickJumper:!0,showTotal:t=>`共 ${t} 条记录`}),B=[{title:"敏感词",dataIndex:"word",key:"word",width:300},{title:"操作",key:"action",width:150,fixed:"right"}],c=async(t=1,e=r.value.pageSize)=>{var a,o;v.value=!0;try{const d=(t-1)*e,k={search:g.value||void 0,limit:e,offset:d},p=await x.get("/api/sensitive-words",{params:k});if(p.data&&Array.isArray(p.data.words))m.value=p.data.words,h.value=p.data.total||0,r.value.total=h.value,r.value.current=t,r.value.pageSize=e;else throw new Error("返回数据格式不正确")}catch(d){_.error(`获取敏感词失败: ${((o=(a=d.response)==null?void 0:a.data)==null?void 0:o.message)||d.message||"未知错误"}`),m.value=[],h.value=0,r.value.total=0}finally{v.value=!1}},z=async()=>{w.value=!0;try{await c(1)}finally{w.value=!1}},A=t=>{const e=t.current,a=t.pageSize;c(e,a)},O=()=>{c(r.value.current)},W=()=>{u.value="",f.value=!0},E=async()=>{var t,e;if(!u.value){_.warning("请输入敏感词");return}y.value=!0;try{const a=await x.post("/api/sensitive-words",{word:u.value});if(a.data.success)_.success(`已添加敏感词 ${u.value}`),f.value=!1,c(r.value.current);else throw new Error(a.data.message||"添加失败")}catch(a){_.error(`添加敏感词失败: ${((e=(t=a.response)==null?void 0:t.data)==null?void 0:e.message)||a.message||"未知错误"}`)}finally{y.value=!1}},I=async t=>{var e,a;try{const o=await x.delete(`/api/sensitive-words/${t.id}`);if(o.data.success)_.success(`已移除敏感词 ${t.word}`),c(r.value.current);else throw new Error(o.data.message||"移除失败")}catch(o){_.error(`移除敏感词失败: ${((a=(e=o.response)==null?void 0:e.data)==null?void 0:a.message)||o.message||"未知错误"}`)}};return F(()=>{c()}),(t,e)=>{const a=Z,o=K,d=j,k=P,p=G,M=ee,N=Y,T=X,V=q;return S(),J("div",ae,[s(d,{style:{"margin-bottom":"16px"}},{default:n(()=>[s(a,{value:g.value,"onUpdate:value":e[0]||(e[0]=i=>g.value=i),placeholder:"搜索敏感词",style:{width:"200px"},onSearch:z,loading:w.value},null,8,["value","loading"]),s(o,{onClick:O},{icon:n(()=>[s(L(H))]),_:1}),s(o,{type:"primary",onClick:W},{default:n(()=>e[3]||(e[3]=[C("添加")])),_:1})]),_:1}),s(p,{columns:B,"data-source":m.value,pagination:r.value,loading:v.value,"row-key":"id",onChange:A,scroll:{x:600,y:500}},{emptyText:n(()=>[v.value?b("",!0):(S(),$(k,{key:0,description:"暂无数据"},{description:n(()=>[Q("span",null,R(m.value.length===0?"当前没有敏感词":"没有匹配的数据"),1)]),_:1}))]),bodyCell:n(({column:i,record:U})=>[i.key==="action"?(S(),$(o,{key:0,size:"small",danger:"",onClick:se=>I(U)},{default:n(()=>e[4]||(e[4]=[C("移除")])),_:2},1032,["onClick"])):b("",!0)]),_:1},8,["data-source","pagination","loading"]),s(V,{open:f.value,"onUpdate:open":e[2]||(e[2]=i=>f.value=i),title:"添加敏感词",onOk:E,"confirm-loading":y.value},{default:n(()=>[s(T,{"label-col":{span:4},"wrapper-col":{span:20}},{default:n(()=>[s(N,{label:"敏感词",required:""},{default:n(()=>[s(M,{value:u.value,"onUpdate:value":e[1]||(e[1]=i=>u.value=i),placeholder:"请输入敏感词"},null,8,["value"])]),_:1})]),_:1})]),_:1},8,["open","confirm-loading"])])}}},de=D(te,[["__scopeId","data-v-ff45dd78"]]);export{de as default};
